<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>XXç”µå•† Â· è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .box {
            border: 1px solid #ddd;
            padding: 10px;
            margin: 10px 0;
        }

        .clock {
            font-size: 20px;
            font-weight: bold;
            color: #336699;
        }

        label {
            display: inline-block;
            width: 120px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 10px;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 4px 8px;
            text-align: center;
        }
    </style>
</head>

<body>
    <script>
        document.write("<h1>XXç”µå•†Â·è¿è¥åå°Â·è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</h1>");
        document.write("<p>æ¬¢è¿ä½¿ç”¨å†…éƒ¨å·¥å…·ï¼Œå®æ—¶æŸ¥çœ‹è®¢å•ä¸é”€å”®æƒ…å†µã€‚</p>");
        document.write(`
  <div style="padding:12px; background:#eef9ff; border-left:5px solid #3aa0e6; margin:10px 0; font-size:15px;">
    <strong>æ¸©é¦¨æç¤ºï¼šæœ¬åº—å½“å‰å¯äº«å—çš„ä¼˜æƒ ä¸åŠ ä»·æ”¿ç­–å¦‚ä¸‹ï¼š</strong>
    <ul style="margin:8px 0 0 20px; line-height:1.6;">
      <li>VIP å®¢æˆ·äº«å—<strong>9 æŠ˜ä¼˜æƒ </strong></li>
      <li>åŠ æ€¥å‘è´§ä»·æ ¼ä¼š<strong>Ã—1.1</strong></li>
      <li>æ¯å°æ—¶å‰10åˆ†é’Ÿå†äº« <strong>8.5 æŠ˜</strong></li>
    </ul>
  </div>
  `);

        var nowForBanner = new Date();
        var minuteForBanner = nowForBanner.getMinutes();

        if (minuteForBanner >= 0 && minuteForBanner <= 9) {
            document.write(`
      <div style="padding:12px; background:#fffbe6; border-left:5px solid #f4d06f; margin:10px 0; font-size:15px;">
        â³ å½“å‰ä¸ºå‰ 10 åˆ†é’Ÿï¼æœ¬å•å¯é¢å¤–äº«å— <strong>8.5 æŠ˜</strong> æ—¶æ®µä¼˜æƒ ï¼
      </div>
    `);
        } else {
            document.write(`
      <div style="padding:12px; background:#f5f5f5; border-left:5px solid #ccc; margin:10px 0; font-size:15px;">
        ğŸ•’ å°è´´å£«ï¼šæ¯ä¸ªæ•´ç‚¹å‰ 10 åˆ†é’Ÿäº«å— 8.5 æŠ˜ä¼˜æƒ ï¼Œè¯·ç•™æ„ä¸‹å•æ—¶é—´ï½
      </div>
    `);
        }
    </script>

    <div class="box">
        <h2>å½“å‰ç³»ç»Ÿæ—¶é—´</h2>
        <div id="clock" class="clock"></div>
    </div>

    <div class="box">
        <h2>æ–°å»ºè®¢å•</h2>
        <form onsubmit="return validateForm();">
            <p>
                <label>å®¢æˆ·åç§°ï¼š</label>
                <input type="text" id="customerName">
            </p>
            <p>
                <label>å•†å“å•ä»·ï¼ˆÂ¥ï¼‰ï¼š</label>
                <input type="text" id="priceInput">
            </p>
            <p>
                <label>æ•°é‡ï¼ˆä»¶ï¼‰ï¼š</label>
                <input type="text" id="qtyInput">
            </p>
            <p>
                <label>å®¢æˆ·ç±»å‹ï¼š</label>
                <select id="customerType">
                    <option value="normal">æ™®é€šå®¢æˆ·</option>
                    <option value="vip">VIP å®¢æˆ·</option>
                </select>
            </p>
            <p>
                <label>åŠ æ€¥å‘è´§ï¼š</label>
                <input type="checkbox" id="urgentFlag"> æ˜¯
            </p>
            <p><button type="submit">æ·»åŠ è®¢å•</button></p>
        </form>

        <div id="orderResult"></div>
    </div>
    <div class="box">
        <h2>é”€å”®çœ‹æ¿</h2>
        <div id="dashboard"></div>
        <div id="orderTable"></div>
    </div>

    <script>
        function padZero(n) {
            return n < 10 ? "0" + n : n;
        }
        function updateClock() {
            var now = new Date();
            var y = now.getFullYear();
            var m = now.getMonth() + 1;
            var d = now.getDate();
            var hh = now.getHours();
            var mm = now.getMinutes();
            var ss = now.getSeconds();

            var weekNames = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];
            var w = weekNames[now.getDay()];

            var timeStr =
                y + "å¹´" + padZero(m) + "æœˆ" + padZero(d) +
                "æ—¥ æ˜ŸæœŸ" + w + " " +
                padZero(hh) + ":" + padZero(mm) + ":" + padZero(ss);

            document.getElementById("clock").innerHTML = timeStr;
        }

        updateClock();
        setInterval(updateClock, 1000);

        var orders = [];

        function validateForm() {
            var nameStr = document.getElementById("customerName").value;
            var priceStr = document.getElementById("priceInput").value;
            var qtyStr = document.getElementById("qtyInput").value;
            var typeStr = document.getElementById("customerType").value;
            var urgentChecked = document.getElementById("urgentFlag").checked;

            var valid = true;
            if (nameStr == null || nameStr.trim() === "") {
                alert("å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼");
                valid = false;
            }

            var price = parseFloat(priceStr);
            if (isNaN(price) || price <= 0) {
                alert("å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº 0 çš„æ•°å­—ï¼");
                valid = false;
            }

            var qty = parseInt(qtyStr, 10);
            if (isNaN(qty) || qty <= 0) {
                alert("æ•°é‡å¿…é¡»æ˜¯å¤§äº 0 çš„æ•´æ•°ï¼");
                valid = false;
            }

            if (!valid) {
                document.getElementById("orderResult").innerHTML =
                    "<p>è®¢å•å½•å…¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¾“å…¥ã€‚</p>";
                return false;
            }

            processOrder(nameStr.trim(), price, qty, typeStr === "vip", urgentChecked);
            return false;
        }

        function processOrder(customerName, price, quantity, isVip, isUrgent) {
            var baseTotal = price * quantity;

            var afterVip = isVip ? baseTotal * 0.9 : baseTotal;

            var afterUrgent = isUrgent ? afterVip * 1.1 : afterVip;

            var now = new Date();
            var minute = now.getMinutes();
            var hitTimeDiscount = false;
            var finalTotal = afterUrgent;

            if (minute >= 0 && minute <= 9) {
                finalTotal *= 0.85;
                hitTimeDiscount = true;
            }

            if (isVip && !hitTimeDiscount) {
                finalTotal *= 0.95;
            }

            var isImportant = isVip && finalTotal > 1000;

            var tipsHtml = "<ul>";
            tipsHtml += isVip ? "<li>VIP 9æŠ˜å·²åº”ç”¨</li>" : "<li>æ™®é€šå®¢æˆ·æ—  VIP ä¼˜æƒ </li>";
            tipsHtml += isUrgent ? "<li>åŠ æ€¥ Ã—1.1 å·²åº”ç”¨</li>" : "<li>æœªåŠ æ€¥</li>";
            tipsHtml += hitTimeDiscount ? "<li>å‘½ä¸­å‰ååˆ†é’Ÿ Ã—0.85</li>" : "<li>æ— æ—¶æ®µæŠ˜æ‰£</li>";
            tipsHtml += (isVip && !hitTimeDiscount) ? "<li>VIPè¡¥å¿æŠ˜æ‰£ Ã—0.95 å·²åº”ç”¨</li>" : "";
            tipsHtml += "</ul>";

            document.getElementById("orderResult").innerHTML =
                "<h3>è®¢å•å½•å…¥æˆåŠŸï¼š</h3>" +
                "<p>å®¢æˆ·åç§°ï¼š" + customerName + "</p>" +
                "<p>åŸºç¡€é‡‘é¢ï¼šÂ¥" + baseTotal.toFixed(2) + "</p>" +
                "<p>VIP åé‡‘é¢ï¼šÂ¥" + afterVip.toFixed(2) + "</p>" +
                "<p>åŠ æ€¥åé‡‘é¢ï¼šÂ¥" + afterUrgent.toFixed(2) + "</p>" +
                (hitTimeDiscount ? "<p>æ—¶æ®µæŠ˜æ‰£åï¼ˆÃ—0.85ï¼‰ï¼šÂ¥" + finalTotal.toFixed(2) + "</p>" : "") +
                ((isVip && !hitTimeDiscount) ? "<p>VIPè¡¥å¿æŠ˜æ‰£åï¼ˆÃ—0.95ï¼‰ï¼šÂ¥" + finalTotal.toFixed(2) + "</p>" : "") +
                "<p>æœ€ç»ˆé‡‘é¢ï¼šÂ¥" + finalTotal.toFixed(2) + "</p>" +
                "<p>è®¢å•ç±»å‹ï¼š" + (isImportant ? "å¤§é¢ VIP è®¢å•" : "æ™®é€šè®¢å•") + "</p>" +
                "<div style='background:#eef; padding:8px;'>ä¼˜æƒ è¯¦æƒ…ï¼š" + tipsHtml + "</div>";

            orders.push({
                name: customerName,
                price: price,
                qty: quantity,
                baseTotal: baseTotal,
                finalTotal: finalTotal,
                isVip: isVip,
                isUrgent: isUrgent,
                hitTimeDiscount: hitTimeDiscount
            });

            renderDashboard();
        }



        function renderDashboard() {
            var orderCount = orders.length;
            var totalSales = 0;
            var totalQuantity = 0;

            for (var i = 0; i < orders.length; i++) {
                totalSales += orders[i].finalTotal;
                totalQuantity += orders[i].qty;
            }

            var avgOrderPrice = orderCount > 0 ? totalSales / orderCount : 0;

            document.getElementById("dashboard").innerHTML =
                "<p>ğŸ“Š æˆäº¤ç»Ÿè®¡ï¼š</p>" +
                "<p>æˆäº¤è®¢å•æ€»æ•°ï¼š" + orderCount + " å•</p>" +
                "<p>æˆäº¤å•†å“æ€»æ•°é‡ï¼š" + totalQuantity + " ä»¶</p>" +
                "<p>é”€å”®æ€»é¢ï¼šÂ¥" + totalSales.toFixed(2) + "</p>" +
                "<p>å¹³å‡è®¢å•é‡‘é¢ï¼šÂ¥" + avgOrderPrice.toFixed(2) + "</p>";

            var tableHtml = "<table><tr>" +
                "<<th>å®¢æˆ·åç§°</</th>" +
                "<<th>å•†å“å•ä»·</</th>" +
                "<<th>è´­ä¹°æ•°é‡</</th>" +
                "<<th>åŸºç¡€é‡‘é¢</</th>" +
                "<<th>VIPçŠ¶æ€</</th>" +
                "<<th>åŠ æ€¥çŠ¶æ€</</th>" +
                "<<th>æ—¶æ®µæŠ˜æ‰£</</th>" +
                "<<th>æœ€ç»ˆé‡‘é¢</</th></tr>";

            for (var j = 0; j < orders.length; j++) {
                var order = orders[j];
                tableHtml += "<tr>" +
                    "<td>" + order.name + "</td>" +
                    "<td>Â¥" + order.price.toFixed(2) + "</td>" +
                    "<td>" + order.qty + "</td>" +
                    "<td>Â¥" + order.baseTotal.toFixed(2) + "</td>" +
                    "<td>" + (order.isVip ? "æ˜¯" : "å¦") + "</td>" +
                    "<td>" + (order.isUrgent ? "æ˜¯" : "å¦") + "</td>" +
                    "<td>" + (order.hitTimeDiscount ? "æ˜¯" : "å¦") + "</td>" +
                    "<td>Â¥" + order.finalTotal.toFixed(2) + "</td>" +
                    "</tr>";
            }

            tableHtml += "</table>";
            document.getElementById("orderTable").innerHTML = tableHtml;
        }
    </script>

</body>

</html>